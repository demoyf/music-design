webpackJsonp([13],{"+VQI":function(t,s,i){"use strict";s.b=function(t="history",s){window.localStorage&&localStorage.setItem(t,s)},s.a=function(t="history"){if(window.localStorage)return localStorage.getItem(t)}},0:function(t,s){},"34KM":function(t,s){},VeaS:function(t,s,i){"use strict";var e="http://106.14.13.178:3000/",n="http://106.14.13.178:3000/";s.a={search_suggestion:e+"search/suggesstion/",search_all:e+"search/all/",billboard:e+"billboard/",get_new_song:e+"song/new_song/",get_song_by_id:e+"song/get_song/",get_artist_song_lsit:e+"song/song_list/",get_hot_artsit:e+"artist/hot_artist/",get_artist_by_id:e+"artist/get_artist/",get_new_album:e+"album/new_album/",get_album_info:e+"album/album_info/",get_artist_album:e+"album/artist_album/",check_user_info:n+"user/check",add_user:n+"user/reg",has_new_url:n+"user/has_new/"}},ZZh2:function(t,s,i){"use strict";s.a={get_song_info:"current_song",get_album_info:"current_album",get_artist_id:"current_artist",get_ting_id:"current_ting",get_play_song_id:"play_song_id",get_has_paly_page:"has_paly_page",jump_album_info:"/page/album_info.html",jump_song_info:"/page/song_list.html",jump_artist_info:"/page/artist.html",jump_play_music:"/page/play_music.html"}},ecdk:function(t,s,i){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e=i("7+uW"),n=i("BO1k"),o=i.n(n),r=i("mvHQ"),_=i.n(r),c=i("bOdI"),l=i.n(c),a=i("VeaS"),h=i("+VQI"),u=i("ZZh2"),d={slove(t){let s=t.split("\n"),i=[];for(let t in s){let e=s[t],n=e.match(/\[\d{2}:\d{2}\.\d{2}\]/gi);if(n&&0!=n.length){let t=e.substr(1,8),s=e.replace(/\[\d{2}:\d{2}\.\d{2}\]/gi,""),n=""!=(s=s.trim()),o={time:60*parseInt(t.substr(0,2))*1e3+1e3*parseInt(t.substr(3,2))+10*parseInt(t.substr(6,2)),lrc_text:s,has_text:n};i.push(o)}}return i}},v={name:"App",data:function(){var t;return t={song_list:[],current:-1,p_height:0,current_top:0,show_active:-1,current_song:void 0,id_list:[],check_list:[],show_loop:!0,song_audio:void 0,current_play:0,is_stop:!1,scroll_obj:{isdown:!1,start_x:0,end_x:0,move_x:0},current_width:0,start_width:0,scroll_timer:void 0,current_duration:0,is_shuffle:1,process_timer:void 0,volumn_height:50,start_height:50,volumn_scroll_obj:{start_y:0,end_y:0,isdown:!1},is_volume:!1},l()(t,"check_list",[]),l()(t,"check_all",!1),l()(t,"is_key_down",!1),l()(t,"key_list",[18,17,39,37,80]),l()(t,"current_key",[]),t},created:function(){var t=this;window.onunload=function(){var s={song_list:t.song_list,id_list:t.id_list,check_list:t.check_list,is_shuffle:t.is_shuffle};h.b(u.a.get_has_paly_page,"0"),localStorage.setItem("before_song_info",_()(s))};var s=localStorage.getItem("before_song_info"),i=h.a(u.a.get_play_song_id),e=localStorage.getItem("play_new_music_list"),n=localStorage.getItem("add_new_music_list"),o=localStorage.getItem("add_new_music");if(s){var r=JSON.parse(s);this.song_list=r.song_list,this.id_list=r.id_list,this.check_list=r.check_list,this.is_shuffle=r.is_shuffle}i&&""!==i?(localStorage.setItem(u.a.get_play_song_id,""),t.push_song(i,!0)):e&&""!==e?(localStorage.setItem("play_new_music_list",""),t.push_song(e,!0)):n&&""!==n?(localStorage.setItem("add_new_music_list",""),t.push_song(n,!0)):o&&""!==o?(localStorage.setItem("add_new_music",""),t.push_song(o,!0)):(this.current=0,this.current_song=this.song_list[0])},mounted:function(){var t=this,s=this;window.addEventListener("storage",function(){if("play_song_id"==event.key){var t=localStorage.getItem(event.key);t&&""!==t&&s.push_song(t,!0),localStorage.setItem(event.key,"")}else if("add_new_music"===event.key){var i=localStorage.getItem(event.key);i&&""!==i&&s.push_song(i,!1),localStorage.setItem(event.key,"")}else if("add_new_music_list"===event.key){var e=localStorage.getItem(event.key);if(e&&""!==e){e.split(",");s.push_song(e,!1)}localStorage.setItem(event.key,"")}else if("play_new_music_list"===event.key){var n=localStorage.getItem(event.key);n&&""!==n&&s.push_song(n,!0),localStorage.setItem(event.key,"")}}),document.body.addEventListener("keydown",function(s){var i=s.keyCode;t.is_key_down=!0,t.key_list.findIndex(function(t){return t==i})>=0&&-1==t.current_key.findIndex(function(t){return t==i})&&t.current_key.push(i)}),document.body.addEventListener("keyup",function(s){t.is_key_down&&3==t.current_key.length&&t.current_key.findIndex(function(t){return 18==t})>=0&&t.current_key.findIndex(function(t){return 17==t})>=0&&(t.current_key.findIndex(function(t){return 37==t})>=0?t.to_previous():t.current_key.findIndex(function(t){return 39==t})>=0?t.to_next():t.current_key.findIndex(function(t){return 80==t})>=0&&(t.is_stop?t.continue_play():t.stop_play())),t.current_key=[],t.is_key_down=!1})},filters:{change_duration:function(t){if(!t&&0!==t)return"暂无";var s="",i=Math.floor(t/60);s+=i>=10?i:"0"+i,s+=":";var e=t%60;return s+=e>=10?e:"0"+e}},watch:{},methods:{start_loop:function(){if(this.show_loop){var t=this.current_song.lrc_list;if(0!==t.length){var s=this;this.p_height=s.$refs.loop_lrc.firstChild.clientHeight,this.scroll_timer?(clearTimeout(this.scroll_timer),i(0)):i()}}function i(e){if(!(s.current>=t.length-1)){var n=(1e3*s.song_audio.currentTime).toFixed(2),o=s.current;o<-1&&(s.current=o=-1);var r=t[o+1],_=0;(_=r.time-n)<=0&&(_=0),s.is_stop||(void 0!==e&&(_=e),s.scroll_timer=setTimeout(function(){s.is_stop||(s.current_top=-(s.p_height*(o-4)<=0?0:s.p_height*(o-4)),s.current++,""!==r.lrc_text&&(s.show_active=s.current),i())},_))}}},play_music:function(t){var s=this;this.song_audio&&this.song_audio.pause(),this.song_audio=null,this.current=-1,this.p_height=0,this.current_to=0,this.show_active=-1,this.current_width=0,this.start_width=0,this.current_duration=0,this.scroll_obj={isdown:!1,start_x:0,end_x:0,move_x:0},this.volumn_scroll_obj={isdown:!1,start_x:0,end_x:0},this.scroll_timer&&clearTimeout(this.scroll_timer),this.process_timer&&clearTimeout(this.process_timer),this.song_audio=document.createElement("audio");var i=this.song_audio;i.src=t,i.volume=.5;var e=1;i.addEventListener("canplaythrough",function(){s.song_audio.src==i.src&&i.play(),1===e&&(s.start_loop(),s.start_process(),e++)}),i.addEventListener("ended",function(){s.song_audio.src==i.src&&s.to_next(1)})},stop_play:function(){this.current--,this.song_audio.pause(),this.is_stop=!0},continue_play:function(){this.song_audio.play(),this.is_stop=!1,this.start_loop(),this.start_process()},start_scroll:function(t){var s=this.scroll_obj;s.isdown=!0,s.start_x=t.clientX},scroll:function(t){var s=this.scroll_obj;if(s.isdown){s.move_x=t.clientX;var i=s.move_x-s.start_x;this.current_width=this.start_width+i}},end_scroll:function(t){var s=this.scroll_obj;if(s.isdown){s.end_x=t.clientX;var i=s.end_x-s.start_x;this.current_width=this.start_width+i,this.start_width=this.current_width,s.isdown=!1,this.change_current_time()}},start_process:function(){var t=this.song_audio,s=(200/(1e3*t.duration)*650).toFixed(2),i=this;this.process_timer&&clearTimeout(this.process_timer),function e(){if(i.scroll_obj.isdown||i.is_stop)return;i.current_duration=Math.floor(t.currentTime);if(i.current_width>=650)return void(i.current_width=650);i.process_timer=setTimeout(function(){var t=i.current_width;i.current_width=parseFloat(t)+parseFloat(s),e()},200)}()},change_scroll:function(){var t=this.current_song.lrc_list,s=(1e3*this.song_audio.currentTime).toFixed(2),i=-1,e=!0,n=!1,r=void 0;try{for(var _,c=o()(t);!(e=(_=c.next()).done);e=!0){var l=_.value;if(i++,s<=l.time){this.current=i-2;var a=l.time-s;return this.start_loop(a),void this.start_process()}i==t.length-1&&(this.start_loop(0),this.start_process())}}catch(t){n=!0,r=t}finally{try{!e&&c.return&&c.return()}finally{if(n)throw r}}},change_current_time:function(){var t=this.current_width,s=this.song_audio,i=t/650*s.duration;if(this.scroll_timer)return s.pause(),s.currentTime=i,s.play(),void this.change_scroll(i)},start_volumn_scroll:function(t){var s=this.volumn_scroll_obj;s.start_y=t.clientY,s.isdown=!0},move_volumn_scroll:function(t){var s=this.volumn_scroll_obj;if(s.isdown){s.end_y=t.clientY;var i=s.end_y-s.start_y;this.volumn_height=this.start_height-i,this.volumn_height>100?this.volumn_height=100:this.volumn_height<0&&(this.volumn_height=0)}},end_volumn_scroll:function(t){var s=this.volumn_scroll_obj;if(s.isdown){s.end_y=t.clientY;var i=s.end_y-s.start_y;this.volumn_height=this.start_height-i,s.isdown=!1,this.volumn_height>100?this.volumn_height=100:this.volumn_height<0&&(this.volumn_height=0),this.start_height=this.volumn_height,this.song_audio.volume=this.volumn_height/100}},change_is_volume:function(){this.is_volume=!this.is_volume},change_shuffle:function(){this.is_shuffle=this.is_shuffle%3+1},my_check_all:function(){this.check_all=!this.check_all;var t=this.check_all,s=!0,i=!1,e=void 0;try{for(var n,r=o()(this.check_list);!(s=(n=r.next()).done);s=!0){n.value.is_check=t}}catch(t){i=!0,e=t}finally{try{!s&&r.return&&r.return()}finally{if(i)throw e}}},check_current:function(t){this.check_list[t].is_check=!this.check_list[t].is_check},stop_music_methods:function(){this.song_audio&&(this.song_audio.pause(),this.song_audio=null),this.song_audio=null,this.current=-1,this.p_height=0,this.current_to=0,this.show_active=-1,this.current_width=0,this.start_width=0,this.current_duration=0,this.scroll_obj={isdown:!1,start_x:0,end_x:0,move_x:0},this.volumn_scroll_obj={isdown:!1,start_x:0,end_x:0},this.scroll_timer&&clearTimeout(this.scroll_timer),this.process_timer&&clearTimeout(this.process_timer)},clear_all_music:function(){this.song_list=[],this.check_list=[],this.id_list=[],this.stop_music_methods()},remove_some_music:function(){var t=[].concat(this.check_list),s=0,i=this.current_play,e=0,n=0,r=!0,_=!1,c=void 0;try{for(var l,a=o()(t);!(r=(l=a.next()).done);r=!0){var h=l.value;if(h.is_check&&s==i&&0==e)e=1;else if(1==e&&!h.is_check){e=2,n=h.song_id;break}s++}}catch(t){_=!0,c=t}finally{try{!r&&a.return&&a.return()}finally{if(_)throw c}}var u=!0,d=!1,v=void 0;try{for(var g,p=o()(t);!(u=(g=p.next()).done);u=!0){g.value.is_check&&(this.song_list.splice(this.check_list.findIndex(function(t){return 1==t.is_check}),1),this.id_list.splice(this.check_list.findIndex(function(t){return 1==t.is_check}),1),this.check_list.splice(this.check_list.findIndex(function(t){return 1==t.is_check}),1))}}catch(t){d=!0,v=t}finally{try{!u&&p.return&&p.return()}finally{if(d)throw v}}if(0==n&&0==this.song_list)this.stop_music_methods();else if(0==n&&1==e)this.current_play=0,this.current_song=this.song_list[this.current_play],this.stop_music_methods(),this.play_music(this.current_song.bitrate.show_link);else if(0!=n&&2==e)this.current_play=this.check_list.findIndex(function(t){return t.song_id==n}),this.current_song=this.song_list[this.current_play],this.stop_music_methods(),this.play_music(this.current_song.bitrate.show_link);else{var m=this.current_song.songinfo.song_id;this.current_play=this.check_list.findIndex(function(t){return t.song_id==m})}},to_next:function(t){var s=this.current_play,i=this.is_shuffle,e=this.song_list;if(1==i)s==e.length-1?(this.current_song=e[0],this.current_play=0,this.play_music(this.current_song.bitrate.show_link)):(this.current_song=e[s+1],this.current_play++,this.play_music(this.current_song.bitrate.show_link));else if(2==i){var n=e.length,o=Math.floor(Math.random()*n+1)-1;o==this.current_play&&--o<0&&(o=n-1),this.current_song=e[o],this.current_play=o,this.play_music(this.current_song.bitrate.show_link)}else 1===t?this.play_music(this.current_song.bitrate.show_link):s==e.length-1?(this.current_song=e[0],this.current_play=0,this.play_music(this.current_song.bitrate.show_link)):(this.current_song=e[s+1],this.current_play++,this.play_music(this.current_song.bitrate.show_link))},to_previous:function(){var t=this.current_play,s=this.song_list,i=s.length-1;if(2!==this.is_shuffle)0==t?(this.current_song=s[i],this.current_play=i,this.play_music(this.current_song.bitrate.show_link)):(this.current_song=s[t-1],this.current_play--,this.play_music(this.current_song.bitrate.show_link));else{var e=s.length,n=Math.floor(Math.random()*e+1)-1;n==this.current_play&&--n<0&&(n=e-1),this.current_song=s[n],this.current_play=n,this.play_music(this.current_song.bitrate.show_link)}},to_index:function(t){if(t!=this.current_play){var s=this.song_list;this.current_song=s[t],this.current_play=t,this.play_music(this.current_song.bitrate.show_link)}},push_song:function(t,s){var i=a.a.get_song_by_id,e=this;if(-1!==t.indexOf(",")){var n=t.split(",");s?this.push_song(n[0],s):this.push_song(n[0],!1);for(var o=1;o<n.length;o++)this.push_song(n[o])}else{if(s){var r=this.id_list.findIndex(function(s){return s==t});if(r>=0)return this.current_song=this.song_list[r],this.current_play=r,void this.play_music(this.current_song.bitrate.show_link)}else{if(this.id_list.findIndex(function(s){return s==t})>=0)return}e.$http.get(i+t).then(function(i){if(200===i.status){var n=i.body,o=n.songinfo.lrclink;e.check_list.push({is_check:e.check_all,song_id:t}),e.$http.get(o).then(function(i){if(200===i.status){var o=i.bodyText;n.lrc_list=d.slove(o),0==n.lrc_list.length?e.show_loop=!1:e.show_loop=!0,e.song_list.push(n),e.id_list.push(t),s&&(e.current_song=n,e.current_play=e.song_list.length-1,e.play_music(n.bitrate.show_link))}})}})}}}},g={render:function(){var t=this,s=t.$createElement,i=t._self._c||s;return t.current_song?i("div",{attrs:{id:"App"}},[i("div",{staticClass:"img-container"},[i("img",{attrs:{src:t.current_song.songinfo.pic_premium}})]),t._v(" "),i("div",{staticClass:"song-info-container"},[i("div",{staticClass:"song-controll"},[t._m(0),t._v(" "),i("button",{staticClass:"music-other-button",attrs:{type:"button",name:"coll-button"},on:{click:t.clear_all_music}},[i("i",{staticClass:"icon-heart-icon"}),t._v("\n        清空列表\n      ")]),t._v(" "),i("button",{staticClass:"music-other-button",attrs:{type:"button",name:"coll-button"},on:{click:t.remove_some_music}},[i("i",{staticClass:"icon-heart-icon"}),t._v("\n        删除\n      ")])]),t._v(" "),i("div",{staticClass:"song-container"},[i("div",{staticClass:"play-list"},[i("div",{staticClass:"header"},[i("div",{staticClass:"check-box",on:{click:t.my_check_all}},[i("i",{directives:[{name:"show",rawName:"v-show",value:!t.check_all,expression:"!check_all"}],staticClass:"icon-check-box-outline-icon"}),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:t.check_all,expression:"check_all"}],staticClass:"icon-check-box-icon"})]),t._v(" "),i("p",{staticClass:"song_p"},[t._v("歌曲")]),t._v(" "),i("p",{staticClass:"aratist_p"},[t._v("歌手")]),t._v(" "),i("p",{staticClass:"duration_p"},[t._v("时长")])]),t._v(" "),i("div",{staticClass:"song-list"},t._l(t.song_list,function(s,e){return i("div",{staticClass:"song_container",class:t.current_play==e?"active":"",on:{dblclick:function(s){t.to_index(e)}}},[i("div",{staticClass:"check-box",on:{click:function(s){t.check_current(e)}}},[i("i",{directives:[{name:"show",rawName:"v-show",value:!t.check_list[e].is_check,expression:"!check_list[index].is_check"}],staticClass:"icon-check-box-outline-icon"}),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:t.check_list[e].is_check,expression:"check_list[index].is_check"}],staticClass:"icon-check-box-icon"})]),t._v(" "),i("p",{staticClass:"song_p"},[t._v(t._s(s.songinfo.title))]),t._v(" "),i("p",{staticClass:"aratist_p"},[t._v(t._s(s.songinfo.author))]),t._v(" "),i("p",{staticClass:"duration_p"},[t._v(t._s(t._f("change_duration")(s.bitrate.file_duration)))])])}))]),t._v(" "),i("div",{staticClass:"song-info"},[i("div",{staticClass:"song-img"},[i("img",{attrs:{src:t.current_song.songinfo.pic_big}})]),t._v(" "),i("div",{staticClass:"info"},[i("p",[t._v("歌曲名："+t._s(t.current_song.songinfo.title))]),t._v(" "),i("p",[t._v("歌手名："+t._s(t.current_song.songinfo.author))]),t._v(" "),i("p",[t._v("专辑名："+t._s(t.current_song.songinfo.album_title))])]),t._v(" "),i("div",{staticClass:"lrc"},[i("div",{ref:"loop_lrc",staticClass:"loop-lrc",style:{top:t.current_top+"px"}},t._l(t.current_song.lrc_list,function(s,e){return i("p",{class:e==t.show_active?"active":"",staticStyle:{"text-align":"center"}},[t._v("\n              "+t._s(s.lrc_text)+"\n            ")])}))])])])]),t._v(" "),i("div",{staticClass:"play-control-container"},[i("div",{staticClass:"play-control-button"},[i("i",{staticClass:"icon-previous-icon icon",on:{click:t.to_previous}}),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:!t.is_stop,expression:"!is_stop"}],staticClass:"icon-pause-icon icon plus",on:{click:t.stop_play}}),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:t.is_stop,expression:"is_stop"}],staticClass:"icon-play-icon icon plus",on:{click:t.continue_play}}),t._v(" "),i("i",{staticClass:"icon-next-icon icon",on:{click:t.to_next}})]),t._v(" "),i("div",{staticClass:"play-process",on:{mousemove:t.scroll,mouseup:t.end_scroll}},[i("div",{staticClass:"current_info"},[i("div",{staticClass:"title"},[t._v("\n          "+t._s(t.current_song.songinfo.title)+"\n        ")]),t._v(" "),i("div",{staticClass:"time"},[t._v("\n          "+t._s(t._f("change_duration")(t.current_duration))+"\n          /"+t._s(t._f("change_duration")(t.current_song.bitrate.file_duration))+"\n        ")])]),t._v(" "),i("div",{staticClass:"process-bottom"}),t._v(" "),i("div",{staticClass:"proces-top"},[i("div",{ref:"scroll_line",staticClass:"scroll-line",style:{width:t.current_width+"px"}}),t._v(" "),i("div",{ref:"control_button",staticClass:"control-button",on:{mousedown:t.start_scroll}})])]),t._v(" "),i("div",{staticClass:"volumn-type-control"},[i("div",{staticClass:"type-control",on:{click:t.change_shuffle}},[i("i",{directives:[{name:"show",rawName:"v-show",value:1===t.is_shuffle,expression:"is_shuffle===1"}],staticClass:"icon-loop-play-icon icon"}),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:2===t.is_shuffle,expression:"is_shuffle===2"}],staticClass:"icon-shuffle-play-icon icon"}),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:3===t.is_shuffle,expression:"is_shuffle===3"}],staticClass:"icon-loop-play-icon icon single-icon"})]),t._v(" "),i("div",{staticClass:"volumn-control"},[i("div",{staticClass:"volumn",on:{mousemove:t.move_volumn_scroll,mouseup:t.end_volumn_scroll}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.is_volume,expression:"is_volume"}],staticClass:"volumn-bottom"}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.is_volume,expression:"is_volume"}],staticClass:"volumn-top"},[i("div",{staticClass:"button-control",on:{mousedown:t.start_volumn_scroll}}),t._v(" "),i("div",{staticClass:"scroll-line",style:{height:t.volumn_height+"px"}})])]),t._v(" "),i("i",{staticClass:"icon-volume-icon icon",on:{click:t.change_is_volume}})])])])]):t._e()},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("button",{staticClass:"music-other-button",attrs:{type:"button",name:"coll-button"}},[s("i",{staticClass:"icon-heart-icon"}),this._v("\n        收藏\n      ")])}]};var p=i("VU/8")(v,g,!1,function(t){i("wj1U")},"data-v-048eeadc",null).exports,m=(i("34KM"),i("Mdbh"));e.a.use(m.a),new e.a({el:"#app",render:t=>t(p)})},wj1U:function(t,s){}},["ecdk"]);
//# sourceMappingURL=play_music.00b3b79398777ffea0da.js.map